{% extends 'base.html.twig' %}

{% block title %}Classe{% endblock %}

{% block body %}
    <h3 class="text-center">{{class|upper}}</h3>
  <a href="{{ path('class_message', {'classReceiver': class.getId()}) }}" class="btn btn-primary btn-lg " role="button" aria-disabled="true"> Message </a>
<hr>
    {% set myRow = 2 %}

    <div class="card">

      <div class="card-title">
          <h3>Graphiques</h3>
      </div>
      <div class="card-body">

          <div>
          <h3 class="titleH3">Mesures</h3>
          <div style="border:2px solid red;width:800px; font-size:14px; text-align: justify;">
          </div>
          <br />
          <div class="container-fluid">
            <div class="row">
              <div id="temperature" class="col"></div>
              <div id="windSpeed" class="col"></div>
              <div id="rainLevel" class="col"></div>
            </div>
          </div>

          </div>
      </div>
    </div>


  <h4>  Relevés de la classe : </h4>
{% for publication in publications %}
{% if myRow == 2 %}
  <div class="row">
  {% set myRow = 0 %}
{% endif %}
<div class="col-md-6" style="float:left">
<div class="container ">
<div class="card tabMyClass">
<h3 class="card-title" style="text-align:center;">  <a href="{{ path('publication_show', {'id': publication.id}) }}">{{ publication.title }}</a> </h3>
  <div class="card-body">
  <a href="{{ path('publication_show', {'id': publication.id}) }}">{{ publication.content }}</a>
  <br></br>
  <hr></hr>
  <h6 class="card-subtitle mb-2 text-muted">{{ publication.date ? publication.date|date('Y-m-d') : '' }}</h6>
  <a href="{{ path('publication_show', {'id': publication.id}) }}" style="text-align:right;"><button class="newbtn">voir le relevé</button> </a>
  </div>
</div>
</div>
</div>
{% if myRow == 1 %}
  </div>
{% endif %}

{% set myRow = myRow + 1 %}
{% endfor %}
{{ knp_pagination_render(publications) }}

          <script type="text/javascript">
              // create a dataSet with groups
              var names = ['Temperature(°C)', 'Wind Speed(km/h)', 'Rain Level(nm)'];
              var windspeed = new vis.DataSet();
              var rainLevel = new vis.DataSet();
              var groups = new vis.DataSet();

              groups.add({
                  id: 2,
                  content: names[0],
                  options: {
                      yAxisOrientation: 'left', // right, left
                      drawPoints: true
                  }
              });

                  windspeed.add({
                  id: 2,
                  content: names[1],
                  options: {
                      yAxisOrientation: 'left', // right, left
                      drawPoints: true
                  }
              });

                  rainLevel.add({
                  id: 2,
                  content: names[2],
                  options: {
                      yAxisOrientation: 'left', // right, left
                      drawPoints: true
                  }
              });


              var containerWindSpeed = document.getElementById('windSpeed'); 
              var containerRainLevel = document.getElementById('rainLevel');
              var container = document.getElementById('temperature');



              var items = [];
              {% for row in temperatures %}
                  items[{{loop.index - 1}}] = {x: "{{row['date']}}" ,y:{{row['value']}},group:2};
              {% endfor %}

              var itemsWs = [];
              {% for row in windSpeeds %}
                  itemsWs[{{loop.index - 1}}] = {x: "{{row['date']}}" ,y:{{row['value']}},group:2};
              {% endfor %}

              var itemsRl = [];
              {% for row in rainLevels %}
                  itemsRl[{{loop.index - 1}}] = {x: "{{row['date']}}" ,y:{{row['value']}},group:2};
              {% endfor %}

              var dataset = new vis.DataSet(items);
              var dataSetWs = new vis.DataSet(itemsWs);
              var dataSetRl = new vis.DataSet(itemsRl);

              var options = {
                  dataAxis: {
                      showMinorLabels: false,
                      right: {
                          title: {
                              text: 'Date'
                          }
                      }
                  },
                  legend: {left:{position:"bottom-left"}},
                  start: '2020-06-01',
                  end: '2020-07-02'
              };
              var optionsWs = {
                  dataAxis: {
                      showMinorLabels: false,
                      right: {
                          title: {
                              text: 'Date'
                          }
                      }
                  },
                  legend: {left:{position:"bottom-left"}},
                  start: '2020-06-01',
                  end: '2020-07-02'
              };
              var optionsRl = {
                  dataAxis: {
                      showMinorLabels: false,
                      right: {
                          title: {
                              text: 'Date'
                          }
                      }
                  },
                  legend: {left:{position:"bottom-left"}},
                  start: '2020-06-01',
                  end: '2020-07-02'
              };
              var graph2d = new vis.Graph2d(container, items, groups, options);
              var graph2dws = new vis.Graph2d(containerWindSpeed, itemsWs, windspeed, optionsWs);
              var graph2dRl = new vis.Graph2d(containerRainLevel, itemsRl, rainLevel, optionsRl);

              

          </script>



{% endblock %}
