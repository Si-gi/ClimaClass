{% extends 'base.html.twig' %}

{% block title %}Classe{% endblock %}

{% block body %}
<div class="container-fluid" style="padding:20px">
<h3 class="text-center" style="font-weight:bold;background-color:whitesmoke;margin-top:5px">Class Dashboard : {{class|upper}}</h3>
        <a href="{{ path('class_message', {'classReceiver': class.getId()}) }}" class="btn btn-primary btn-lg " role="button" aria-disabled="true"> Message <i class="fa fa-envelope"></i> </a>

<div class="row" style="margin-top:20px">

<div class="col" style="background-color:#ffd68d;margin-right:15px;border-radius:10px">
            
                        <div>
            <div  >
            <h4 style="text-align:center; font-weight:bold;margin-bottom:30px">Measures</h4>
            {% set myRow = 2 %}


                <div>
                <br />
                <div class="container-fluid">
                    <div class="d-flex flex-column justify-content-around" >
                    <div id="temperature" class="col" style="margin-bottom:20px;background-color:white"></div>
                    <div id="windSpeed" class="col" style="margin-bottom:20px;background-color:white"></div>
                    <div id="rainLevel" class="col" style="background-color:white"></div>
                    </div>
                </div>

                </div>
            </div>
            </div>

</div>
<div class="col" style="background-color:white;border-radius:10px">


  <h4 style="text-align:center; font-weight:bold;margin-bottom:30px">Class Publications</h4>
{% for publication in publications %}
  {% if myRow == 2 %}
    <div class="row">
    {% set myRow = 0 %}
  {% endif %}
  <div class="col-md-6" style="float:left">
  <div class="container">
  <div class="card tabPublication" style="background-color:#D6F9E6">
  <h3 class="card-title" style="text-align:center;">  <a href="{{ path('publication_show', {'id': publication.id}) }}">{{ publication.title }}</a> </h3>
    <div class="card-body">
    <p>{{ publication.content }}</p>
    <br></br>
    <hr></hr>
    <h6 class="card-subtitle mb-2 text-muted">{{ publication.date ? publication.date|date('Y-m-d') : '' }}</h6>
    <a href="{{ path('publication_show', {'id': publication.id}) }}" style="text-align:right;"><button class="newbtn">voir le relevé</button> </a>
    <a href="{{ path('seeFiles', {'id_releve': publication.id}) }}" style="text-align:right;"><button class="newbtn">voir les fichiers</button> </a>
    </div>
  </div>
  </div>
  </div>
  {% if myRow == 1 %}
    </div>
  {% endif %}

  {% set myRow = myRow + 1 %}
{% endfor %}
{{ knp_pagination_render(publications) }}
</div>
</div>
          <script type="text/javascript">
              // create a dataSet with groups
              var names = ['Temperature(°C)', 'Wind Speed(km/h)', 'Rain Level(nm)'];
              var windspeed = new vis.DataSet();
              var rainLevel = new vis.DataSet();
              var groups = new vis.DataSet();

              groups.add({
                  id: 2,
                  content: names[0],
                  options: {
                      yAxisOrientation: 'left', // right, left
                      drawPoints: true
                  }
              });

                  windspeed.add({
                  id: 2,
                  content: names[1],
                  options: {
                      yAxisOrientation: 'left', // right, left
                      drawPoints: true
                  }
              });

                  rainLevel.add({
                  id: 2,
                  content: names[2],
                  options: {
                      yAxisOrientation: 'left', // right, left
                      drawPoints: true
                  }
              });


              var containerWindSpeed = document.getElementById('windSpeed'); 
              var containerRainLevel = document.getElementById('rainLevel');
              var container = document.getElementById('temperature');



              var items = [];
              {% for row in temperatures %}
                  items[{{loop.index - 1}}] = {x: "{{row['date']}}" ,y:{{row['value']}},group:2};
              {% endfor %}

              var itemsWs = [];
              {% for row in windSpeeds %}
                  itemsWs[{{loop.index - 1}}] = {x: "{{row['date']}}" ,y:{{row['value']}},group:2};
              {% endfor %}

              var itemsRl = [];
              {% for row in rainLevels %}
                  itemsRl[{{loop.index - 1}}] = {x: "{{row['date']}}" ,y:{{row['value']}},group:2};
              {% endfor %}

              var dataset = new vis.DataSet(items);
              var dataSetWs = new vis.DataSet(itemsWs);
              var dataSetRl = new vis.DataSet(itemsRl);

              var options = {
                  dataAxis: {
                      showMinorLabels: false,
                      right: {
                          title: {
                              text: 'Date'
                          }
                      }
                  },
                  legend: {left:{position:"bottom-left"}},
                  start: '2020-06-01',
                  end: '2020-07-02'
              };
              var optionsWs = {
                  dataAxis: {
                      showMinorLabels: false,
                      right: {
                          title: {
                              text: 'Date'
                          }
                      }
                  },
                  legend: {left:{position:"bottom-left"}},
                  start: '2020-06-01',
                  end: '2020-07-02'
              };
              var optionsRl = {
                  dataAxis: {
                      showMinorLabels: false,
                      right: {
                          title: {
                              text: 'Date'
                          }
                      }
                  },
                  legend: {left:{position:"bottom-left"}},
                  start: '2020-06-01',
                  end: '2020-07-02'
              };
              var graph2d = new vis.Graph2d(container, items, groups, options);
              var graph2dws = new vis.Graph2d(containerWindSpeed, itemsWs, windspeed, optionsWs);
              var graph2dRl = new vis.Graph2d(containerRainLevel, itemsRl, rainLevel, optionsRl);

              

          </script>

</div>

{% endblock %}
